let Mark,readSubjectById,updateSubject;_bab‍.x([["deleteMark",()=>deleteMark],["deleteMarkAPI",()=>deleteMarkAPI]]);_bab‍.w("../../class/mark",[["Mark",["Mark"],function(v){Mark=v}]]);_bab‍.w("../subject/readSubject",[["readSubjectById",["readSubjectById"],function(v){readSubjectById=v}]]);_bab‍.w("../subject/updateSubject",[["updateSubject",["updateSubject"],function(v){updateSubject=v}]]);



       const deleteMark = async (id) => {
	try {
		const deletedMark = await Mark.findByIdAndDelete(id, {
			useFindAndModify: true,
		});

		if (deletedMark) {
			const subjectToUpdate = await readSubjectById(deletedMark.subjectId);

			subjectToUpdate.marks = subjectToUpdate.marks.filter((markId) => {
				if (markId._id.equals(deletedMark.id)) {
					return false;
				}
				return true;
			});

			updateSubject(subjectToUpdate.id, subjectToUpdate);

			return deletedMark;
		} else {
			throw new Error('Nota não econtrada');
		}
	} catch (e) {
		throw new Error('Não foi possível deletar nota');
	}
};

       const deleteMarkAPI = async (req, res) => {
	const deletedMark = await deleteMark(req.params.id);
	res.status(200).json(deletedMark);
};
